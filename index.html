<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>å¿ƒçµæ¸¯æ¹¾ - æŠ‘éƒç—‡æ²»ç–—åŠ©æ‰‹</title>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/luxon@2.0.2"></script>
	<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.0.0"></script>
	<style>
		:root {
			--primary-color: #5e72e4;
			--secondary-color: #f7fafc;
			--accent-color: #667eea;
			--text-color: #2d3748;
			--light-text: #f8f9fa;
			--glass-bg: rgba(255, 255, 255, 0.15);
			--glass-border: rgba(255, 255, 255, 0.18);
		}

		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
			font-family: 'PingFang SC', 'Helvetica Neue', Arial, sans-serif;
		}

		body {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: var(--text-color);
			min-height: 100vh;
			overflow-x: hidden;
			animation: fadeIn 1.5s ease-out;
		}

		@keyframes fadeIn {
			from { opacity: 0; }
			to { opacity: 1; }
		}

		.container {
			max-width: 1200px;
			margin: 0 auto;
			padding: 20px;
		}

		header {
			text-align: center;
			margin-bottom: 30px;
			color: var(--light-text);
			animation: slideDown 1s ease-out;
		}

		@keyframes slideDown {
			from { transform: translateY(-50px); opacity: 0; }
			to { transform: translateY(0); opacity: 1; }
		}

		h1 {
			font-size: 2.5rem;
			margin-bottom: 10px;
			font-weight: 300;
			text-shadow: 0 2px 4px rgba(0,0,0,0.1);
		}

		.subtitle {
			font-size: 1.2rem;
			opacity: 0.8;
		}

		.card {
			background: var(--glass-bg);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border-radius: 15px;
			padding: 25px;
			margin-bottom: 30px;
			box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
			border: 1px solid var(--glass-border);
			transition: transform 0.3s ease, box-shadow 0.3s ease;
			color: var(--light-text);
		}

		.card:hover {
			transform: translateY(-5px);
			box-shadow: 0 12px 40px 0 rgba(31, 38, 135, 0.3);
		}

		.card-title {
			font-size: 1.5rem;
			margin-bottom: 20px;
			font-weight: 400;
			border-bottom: 1px solid rgba(255,255,255,0.1);
			padding-bottom: 10px;
		}

		.tab-container {
			display: flex;
			margin-bottom: 20px;
			border-bottom: 1px solid rgba(255,255,255,0.1);
		}

		.tab {
			padding: 10px 20px;
			cursor: pointer;
			transition: all 0.3s ease;
			border-bottom: 3px solid transparent;
		}

		.tab:hover {
			background: rgba(255,255,255,0.1);
		}

		.tab.active {
			border-bottom: 3px solid var(--light-text);
			font-weight: 500;
		}

		.tab-content {
			display: none;
		}

		.tab-content.active {
			display: block;
			animation: fadeIn 0.5s ease-out;
		}

		.breathing-circle {
			width: 200px;
			height: 200px;
			border-radius: 50%;
			background: rgba(255,255,255,0.2);
			margin: 30px auto;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 1.5rem;
			color: white;
			animation: pulse 8s infinite ease-in-out;
			transition: all 0.3s ease;
			cursor: pointer;
		}

		@keyframes pulse {
			0%, 100% { transform: scale(0.9); background: rgba(255,255,255,0.2); }
			50% { transform: scale(1.1); background: rgba(255,255,255,0.4); }
		}

		.breathing-instruction {
			text-align: center;
			margin-bottom: 20px;
			line-height: 1.6;
		}

		.btn {
			background: rgba(255,255,255,0.2);
			border: none;
			color: white;
			padding: 12px 25px;
			border-radius: 30px;
			cursor: pointer;
			transition: all 0.3s ease;
			font-size: 1rem;
			outline: none;
			margin: 5px;
			backdrop-filter: blur(5px);
		}

		.btn:hover {
			background: rgba(255,255,255,0.3);
			transform: translateY(-2px);
		}

		.btn-primary {
			background: rgba(255,255,255,0.3);
			font-weight: 500;
		}

		.btn-primary:hover {
			background: rgba(255,255,255,0.4);
		}

		.quote-container {
			margin: 20px 0;
			padding: 20px;
			background: rgba(255,255,255,0.1);
			border-radius: 10px;
			position: relative;
		}

		.quote-text {
			font-style: italic;
			font-size: 1.1rem;
			line-height: 1.6;
			margin-bottom: 10px;
		}

		.quote-author {
			text-align: right;
			font-weight: 500;
		}

		.mood-selector {
			display: flex;
			justify-content: space-between;
			margin: 20px 0;
		}

		.mood-option {
			text-align: center;
			cursor: pointer;
			transition: all 0.3s ease;
			padding: 10px;
			border-radius: 10px;
		}

		.mood-option:hover {
			background: rgba(255,255,255,0.1);
		}

		.mood-option.selected {
			background: rgba(255,255,255,0.2);
			transform: scale(1.05);
		}

		.mood-icon {
			font-size: 2rem;
			margin-bottom: 5px;
		}

		.mood-label {
			font-size: 0.9rem;
		}

		.note-input {
			width: 100%;
			background: rgba(255,255,255,0.1);
			border: none;
			border-radius: 10px;
			padding: 15px;
			color: white;
			margin: 15px 0;
			resize: none;
			outline: none;
		}

		.note-input::placeholder {
			color: rgba(255,255,255,0.6);
		}

		.history-item {
			background: rgba(255,255,255,0.1);
			border-radius: 10px;
			padding: 15px;
			margin-bottom: 10px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			transition: all 0.3s ease;
		}

		.history-item:hover {
			background: rgba(255,255,255,0.2);
		}

		.history-date {
			font-size: 0.9rem;
			opacity: 0.8;
		}

		.history-mood {
			font-weight: 500;
		}

		.chart-container {
			position: relative;
			height: 300px;
			margin-top: 30px;
		}

		.question-item {
			margin-bottom: 20px;
		}

		.question-text {
			margin-bottom: 10px;
			font-weight: 500;
		}

		.option-item {
			margin-bottom: 8px;
		}

		.option-label {
			display: flex;
			align-items: center;
			cursor: pointer;
		}

		.option-radio {
			margin-right: 10px;
		}

		.test-result {
			margin-top: 20px;
			padding: 15px;
			background: rgba(255,255,255,0.1);
			border-radius: 10px;
			display: none;
		}

		.chat-container {
			height: 300px;
			overflow-y: auto;
			margin-bottom: 15px;
			padding: 10px;
			background: rgba(255,255,255,0.1);
			border-radius: 10px;
		}

		.message {
			margin-bottom: 10px;
			padding: 10px 15px;
			border-radius: 15px;
			max-width: 80%;
			word-wrap: break-word;
		}

		.user-message {
			background: rgba(255,255,255,0.2);
			margin-left: auto;
			border-bottom-right-radius: 5px;
		}

		.bot-message {
			background: rgba(255,255,255,0.1);
			margin-right: auto;
			border-bottom-left-radius: 5px;
		}

		.chat-input-container {
			display: flex;
		}

		.chat-input {
			flex-grow: 1;
			background: rgba(255,255,255,0.1);
			border: none;
			border-radius: 20px;
			padding: 12px 15px;
			color: white;
			outline: none;
		}

		.chat-input::placeholder {
			color: rgba(255,255,255,0.6);
		}

		.send-btn {
			background: rgba(255,255,255,0.2);
			border: none;
			color: white;
			border-radius: 50%;
			width: 40px;
			height: 40px;
			margin-left: 10px;
			cursor: pointer;
			transition: all 0.3s ease;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.send-btn:hover {
			background: rgba(255,255,255,0.3);
		}

		.loading {
			display: inline-block;
			width: 20px;
			height: 20px;
			border: 3px solid rgba(255,255,255,0.3);
			border-radius: 50%;
			border-top-color: white;
			animation: spin 1s ease-in-out infinite;
			margin-left: 10px;
		}

		@keyframes spin {
			to { transform: rotate(360deg); }
		}

		/* éŸ³ä¹æ’­æ”¾å™¨æ ·å¼ */
		.music-player {
			position: fixed;
			bottom: 20px;
			left: 50%;
			transform: translateX(-50%);
			background: var(--glass-bg);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
			border-radius: 30px;
			padding: 10px 20px;
			display: flex;
			align-items: center;
			box-shadow: 0 4px 16px rgba(0,0,0,0.2);
			z-index: 100;
			border: 1px solid var(--glass-border);
		}

		.music-controls {
			display: flex;
			align-items: center;
		}

		.music-btn {
			background: none;
			border: none;
			color: white;
			font-size: 1.2rem;
			cursor: pointer;
			margin: 0 10px;
			outline: none;
			transition: all 0.3s ease;
		}

		.music-btn:hover {
			transform: scale(1.1);
		}

		.music-info {
			margin-left: 15px;
			font-size: 0.9rem;
			max-width: 200px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		footer {
			text-align: center;
			margin-top: 50px;
			color: rgba(255,255,255,0.6);
			font-size: 0.9rem;
			padding-bottom: 80px; /* ä¸ºéŸ³ä¹æ’­æ”¾å™¨ç•™å‡ºç©ºé—´ */
		}

		/* Responsive adjustments */
		@media (max-width: 768px) {
			.container {
				padding: 15px;
			}
			
			h1 {
				font-size: 2rem;
			}
			
			.card {
				padding: 20px;
			}
			
			.breathing-circle {
				width: 150px;
				height: 150px;
			}
			
			.mood-selector {
				flex-wrap: wrap;
				justify-content: center;
			}
			
			.mood-option {
				width: 25%;
				margin-bottom: 10px;
			}
			
			.music-player {
				width: 90%;
				padding: 8px 15px;
			}
			
			.music-info {
				max-width: 120px;
			}
		}

		@media (max-width: 480px) {
			.tab {
				padding: 8px 12px;
				font-size: 0.9rem;
			}
			
			.mood-option {
				width: 33%;
			}
			
			.music-player {
				bottom: 10px;
				padding: 6px 12px;
			}
			
			.music-btn {
				margin: 0 5px;
				font-size: 1rem;
			}
			
			.music-info {
				font-size: 0.8rem;
				max-width: 100px;
			}
		}
	</style>
</head>
<body>
	<audio id="bgMusic">
		<source src="https://er-sycdn.kuwo.cn/40597672e625ea45cb41da6a5dd665f1/68b96c0b/resource/30106/trackmedia/M500001a3QpG0HsOAP.mp3?bitrate$128&from=vip" type="audio/mpeg">
	</audio>

	<div class="container">
		<header>
			<h1>å¿ƒçµæ¸¯æ¹¾</h1>
			<p class="subtitle">æ‚¨çš„æŠ‘éƒç—‡æ²»ç–—åŠ©æ‰‹</p>
		</header>

		<div class="tab-container">
			<div class="tab active" data-tab="meditation">å‘¼å¸å†¥æƒ³</div>
			<div class="tab" data-tab="quotes">åäººå¯„è¯­</div>
			<div class="tab" data-tab="mood">æƒ…ç»ªè®°å½•</div>
			<div class="tab" data-tab="test">è‡ªè¯„æµ‹è¯•</div>
			<div class="tab" data-tab="chat">å¿ƒç†å’¨è¯¢</div>
		</div>

		<!-- å‘¼å¸å†¥æƒ³ -->
		<div class="tab-content active" id="meditation">
			<div class="card">
				<h2 class="card-title">å‘¼å¸å†¥æƒ³ç»ƒä¹ </h2>
				<p class="breathing-instruction">
					æ·±å‘¼å¸å¯ä»¥å¸®åŠ©ç¼“è§£ç„¦è™‘å’ŒæŠ‘éƒç—‡çŠ¶ã€‚<br>
					ç‚¹å‡»ä¸‹é¢çš„åœ†åœˆå¼€å§‹å‘¼å¸ç»ƒä¹ ï¼Œè·ŸéšåŠ¨ç”»èŠ‚å¥å‘¼å¸ã€‚<br>
					å¸æ°”æ—¶åœ†åœˆä¼šå˜å¤§ï¼Œå‘¼æ°”æ—¶åœ†åœˆä¼šå˜å°ã€‚
				</p>
				<div class="breathing-circle" id="breathingCircle">ç‚¹å‡»å¼€å§‹</div>
				<div class="text-center">
					<button class="btn btn-primary" id="resetBreathing">é‡ç½®</button>
				</div>
			</div>
		</div>

		<!-- åäººå¯„è¯­ -->
		<div class="tab-content" id="quotes">
			<div class="card">
				<h2 class="card-title">åäººå¯„è¯­</h2>
				<div id="quoteDisplay">
					<div class="quote-container">
						<p class="quote-text">"ç”Ÿæ´»å°±åƒæµ·æ´‹ï¼Œåªæœ‰æ„å¿—åšå¼ºçš„äººæ‰èƒ½åˆ°è¾¾å½¼å²¸ã€‚"</p>
						<p class="quote-author">â€”â€” é©¬å…‹æ€</p>
					</div>
				</div>
				<div class="text-center">
					<button class="btn btn-primary" id="newQuote">æ–°çš„å¯„è¯­</button>
				</div>
			</div>
		</div>

		<!-- æƒ…ç»ªè®°å½• -->
		<div class="tab-content" id="mood">
			<div class="card">
				<h2 class="card-title">è®°å½•ä»Šæ—¥æƒ…ç»ª</h2>
				<div class="mood-selector" id="moodSelector">
					<div class="mood-option" data-mood="5">
						<div class="mood-icon">ğŸ˜„</div>
						<div class="mood-label">éå¸¸å¼€å¿ƒ</div>
					</div>
					<div class="mood-option" data-mood="4">
						<div class="mood-icon">ğŸ˜Š</div>
						<div class="mood-label">å¼€å¿ƒ</div>
					</div>
					<div class="mood-option" data-mood="3">
						<div class="mood-icon">ğŸ˜</div>
						<div class="mood-label">ä¸€èˆ¬</div>
					</div>
					<div class="mood-option" data-mood="2">
						<div class="mood-icon">ğŸ˜</div>
						<div class="mood-label">ä½è½</div>
					</div>
					<div class="mood-option" data-mood="1">
						<div class="mood-icon">ğŸ˜¢</div>
						<div class="mood-label">éå¸¸ä½è½</div>
					</div>
				</div>
				<textarea class="note-input" id="moodNote" placeholder="è®°å½•ä¸‹ä»Šå¤©çš„å¿ƒæƒ…å’Œæƒ³æ³•..."></textarea>
				<div class="text-center">
					<button class="btn btn-primary" id="saveMood">ä¿å­˜è®°å½•</button>
					<button class="btn" id="showHistory">æŸ¥çœ‹å†å²</button>
				</div>
				
				<div id="historyContainer" style="display: none;">
					<h3 class="card-title" style="margin-top: 20px;">æƒ…ç»ªè®°å½•å†å²</h3>
					<div id="historyList"></div>
				</div>
				
				<div class="chart-container">
					<canvas id="moodChart"></canvas>
				</div>
			</div>
		</div>

		<!-- è‡ªè¯„æµ‹è¯• -->
		<div class="tab-content" id="test">
			<div class="card">
				<h2 class="card-title">æŠ‘éƒç—‡è‡ªè¯„é‡è¡¨ (PHQ-9)</h2>
				<p style="margin-bottom: 20px;">è¯·æ ¹æ®è¿‡å»ä¸¤å‘¨çš„æƒ…å†µï¼Œå›ç­”ä»¥ä¸‹é—®é¢˜ï¼š</p>
				
				<div id="testQuestions">
					<div class="question-item">
						<p class="question-text">1. åšäº‹æ—¶æä¸èµ·åŠ²æˆ–æ²¡æœ‰å…´è¶£</p>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q1" value="0" class="option-radio"> å®Œå…¨æ²¡æœ‰ (0åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q1" value="1" class="option-radio"> æœ‰å‡ å¤© (1åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q1" value="2" class="option-radio"> ä¸€åŠä»¥ä¸Šæ—¶é—´ (2åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q1" value="3" class="option-radio"> å‡ ä¹æ¯å¤© (3åˆ†)
							</label>
						</div>
					</div>
					
					<div class="question-item">
						<p class="question-text">2. æ„Ÿåˆ°å¿ƒæƒ…ä½è½ã€æ²®ä¸§æˆ–ç»æœ›</p>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q2" value="0" class="option-radio"> å®Œå…¨æ²¡æœ‰ (0åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q2" value="1" class="option-radio"> æœ‰å‡ å¤© (1åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q2" value="2" class="option-radio"> ä¸€åŠä»¥ä¸Šæ—¶é—´ (2åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q2" value="3" class="option-radio"> å‡ ä¹æ¯å¤© (3åˆ†)
							</label>
						</div>
					</div>
					
					<div class="question-item">
						<p class="question-text">3. å…¥ç¡å›°éš¾ã€ç¡ä¸å®‰ç¨³æˆ–ç¡çœ è¿‡å¤š</p>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q3" value="0" class="option-radio"> å®Œå…¨æ²¡æœ‰ (0åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q3" value="1" class="option-radio"> æœ‰å‡ å¤© (1åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q3" value="2" class="option-radio"> ä¸€åŠä»¥ä¸Šæ—¶é—´ (2åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q3" value="3" class="option-radio"> å‡ ä¹æ¯å¤© (3åˆ†)
							</label>
						</div>
					</div>
					
					<div class="question-item">
						<p class="question-text">4. æ„Ÿè§‰ç–²å€¦æˆ–æ²¡æœ‰æ´»åŠ›</p>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q4" value="0" class="option-radio"> å®Œå…¨æ²¡æœ‰ (0åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q4" value="1" class="option-radio"> æœ‰å‡ å¤© (1åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q4" value="2" class="option-radio"> ä¸€åŠä»¥ä¸Šæ—¶é—´ (2åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q4" value="3" class="option-radio"> å‡ ä¹æ¯å¤© (3åˆ†)
							</label>
						</div>
					</div>
					
					<div class="question-item">
						<p class="question-text">5. é£Ÿæ¬²ä¸æŒ¯æˆ–åƒå¤ªå¤š</p>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q5" value="0" class="option-radio"> å®Œå…¨æ²¡æœ‰ (0åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q5" value="1" class="option-radio"> æœ‰å‡ å¤© (1åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q5" value="2" class="option-radio"> ä¸€åŠä»¥ä¸Šæ—¶é—´ (2åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q5" value="3" class="option-radio"> å‡ ä¹æ¯å¤© (3åˆ†)
							</label>
						</div>
					</div>
					
					<div class="question-item">
						<p class="question-text">6. è§‰å¾—è‡ªå·±å¾ˆç³Ÿæˆ–è§‰å¾—è‡ªå·±å¾ˆå¤±è´¥ï¼Œæˆ–è®©è‡ªå·±æˆ–å®¶äººå¤±æœ›</p>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q6" value="0" class="option-radio"> å®Œå…¨æ²¡æœ‰ (0åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q6" value="1" class="option-radio"> æœ‰å‡ å¤© (1åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q6" value="2" class="option-radio"> ä¸€åŠä»¥ä¸Šæ—¶é—´ (2åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q6" value="3" class="option-radio"> å‡ ä¹æ¯å¤© (3åˆ†)
							</label>
						</div>
					</div>
					
					<div class="question-item">
						<p class="question-text">7. å¯¹äº‹ç‰©ä¸“æ³¨æœ‰å›°éš¾ï¼Œä¾‹å¦‚é˜…è¯»æŠ¥çº¸æˆ–çœ‹ç”µè§†æ—¶</p>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q7" value="0" class="option-radio"> å®Œå…¨æ²¡æœ‰ (0åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q7" value="1" class="option-radio"> æœ‰å‡ å¤© (1åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q7" value="2" class="option-radio"> ä¸€åŠä»¥ä¸Šæ—¶é—´ (2åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q7" value="3" class="option-radio"> å‡ ä¹æ¯å¤© (3åˆ†)
							</label>
						</div>
					</div>
					
					<div class="question-item">
						<p class="question-text">8. åŠ¨ä½œæˆ–è¯´è¯é€Ÿåº¦ç¼“æ…¢åˆ°åˆ«äººå·²ç»å¯Ÿè§‰ï¼Ÿæˆ–æ­£å¥½ç›¸åï¼Œçƒ¦èºæˆ–åç«‹ä¸å®‰ã€åŠ¨æ¥åŠ¨å»çš„æƒ…å†µæ›´èƒœäºå¹³å¸¸</p>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q8" value="0" class="option-radio"> å®Œå…¨æ²¡æœ‰ (0åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q8" value="1" class="option-radio"> æœ‰å‡ å¤© (1åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q8" value="2" class="option-radio"> ä¸€åŠä»¥ä¸Šæ—¶é—´ (2åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q8" value="3" class="option-radio"> å‡ ä¹æ¯å¤© (3åˆ†)
							</label>
						</div>
					</div>
					
					<div class="question-item">
						<p class="question-text">9. æœ‰ä¸å¦‚æ­»æ‰æˆ–ç”¨æŸç§æ–¹å¼ä¼¤å®³è‡ªå·±çš„å¿µå¤´</p>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q9" value="0" class="option-radio"> å®Œå…¨æ²¡æœ‰ (0åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q9" value="1" class="option-radio"> æœ‰å‡ å¤© (1åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q9" value="2" class="option-radio"> ä¸€åŠä»¥ä¸Šæ—¶é—´ (2åˆ†)
							</label>
						</div>
						<div class="option-item">
							<label class="option-label">
								<input type="radio" name="q9" value="3" class="option-radio"> å‡ ä¹æ¯å¤© (3åˆ†)
							</label>
						</div>
					</div>
				</div>
				
				<div class="text-center">
					<button class="btn btn-primary" id="submitTest">æäº¤æµ‹è¯•</button>
				</div>
				
				<div class="test-result" id="testResult">
					<h3 class="card-title">æµ‹è¯•ç»“æœ</h3>
					<p id="resultText"></p>
					<p id="resultSuggestion"></p>
				</div>
			</div>
		</div>

		<!-- å¿ƒç†å’¨è¯¢ -->
		<div class="tab-content" id="chat">
			<div class="card">
				<h2 class="card-title">å¿ƒç†å’¨è¯¢</h2>
				<p style="margin-bottom: 20px;">æ‚¨å¯ä»¥åœ¨è¿™é‡Œä¸æˆ‘ä»¬çš„ä¸“ä¸šå¿ƒç†å’¨è¯¢å¸ˆäº¤æµã€‚</p>
				
				<div class="chat-container" id="chatContainer">
					<div class="message bot-message">
						æ‚¨å¥½ï¼Œæˆ‘æ˜¯KSFå¿ƒç†å’¨è¯¢å¸ˆã€‚è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©æ‚¨çš„å—ï¼Ÿ
					</div>
				</div>
				
				<div class="chat-input-container">
					<input type="text" class="chat-input" id="chatInput" placeholder="è¾“å…¥æ‚¨çš„é—®é¢˜...">
					<button class="send-btn" id="sendMessage">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<line x1="22" y1="2" x2="11" y2="13"></line>
							<polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
						</svg>
					</button>
				</div>
			</div>
		</div>

		<footer>
			<p>å¿ƒçµæ¸¯æ¹¾ Â© 2023 - æ‚¨çš„å¿ƒç†å¥åº·ä¼™ä¼´</p>
		</footer>
	</div>

	<!-- éŸ³ä¹æ’­æ”¾å™¨ -->
	<div class="music-player">
		<div class="music-controls">
			<button class="music-btn" id="prevSong">â®</button>
			<button class="music-btn" id="playPause">â¯</button>
			<button class="music-btn" id="nextSong">â­</button>
		</div>
		<div class="music-info" id="musicInfo">èƒŒæ™¯éŸ³ä¹</div>
	</div>

	<script>
		// å…¨å±€å˜é‡
		let moodChart;
		let selectedMood = null;
		let isBreathing = false;
		let breathingInterval;
		let currentQuoteIndex = 0;
		
		// åäººåè¨€åº“
		const quotes = [
			{
				text: "ç”Ÿæ´»å°±åƒæµ·æ´‹ï¼Œåªæœ‰æ„å¿—åšå¼ºçš„äººæ‰èƒ½åˆ°è¾¾å½¼å²¸ã€‚",
				author: "é©¬å…‹æ€"
			},
			{
				text: "ä¸–ç•Œä¸Šåªæœ‰ä¸€ç§çœŸæ­£çš„è‹±é›„ä¸»ä¹‰ï¼Œé‚£å°±æ˜¯åœ¨è®¤æ¸…ç”Ÿæ´»çš„çœŸç›¸åä¾ç„¶çƒ­çˆ±ç”Ÿæ´»ã€‚",
				author: "ç½—æ›¼Â·ç½—å…°"
			},
			{
				text: "ç”Ÿå‘½ä¸­æœ€ä¼Ÿå¤§çš„å…‰è¾‰ä¸åœ¨äºæ°¸ä¸å è½ï¼Œè€Œåœ¨äºå è½åæ€»èƒ½å†åº¦å‡èµ·ã€‚",
				author: "æ›¼å¾·æ‹‰"
			},
			{
				text: "é»‘å¤œæ— è®ºæ€æ ·æ‚ é•¿ï¼Œç™½æ˜¼æ€»ä¼šåˆ°æ¥ã€‚",
				author: "èå£«æ¯”äºš"
			},
			{
				text: "ä¸€ä¸ªäººå¯ä»¥è¢«æ¯ç­ï¼Œä½†ä¸èƒ½è¢«æ‰“è´¥ã€‚",
				author: "æµ·æ˜å¨"
			},
			{
				text: "ç”Ÿæ´»ä¸å¯èƒ½åƒä½ æƒ³è±¡å¾—é‚£ä¹ˆå¥½ï¼Œä½†ä¹Ÿä¸ä¼šåƒä½ æƒ³è±¡å¾—é‚£ä¹ˆç³Ÿã€‚",
				author: "è«æ³Šæ¡‘"
			},
			{
				text: "å½“ä½ å‡è§†æ·±æ¸Šæ—¶ï¼Œæ·±æ¸Šä¹Ÿåœ¨å‡è§†ç€ä½ ã€‚",
				author: "å°¼é‡‡"
			},
			{
				text: "äººç”Ÿçš„é“è·¯è™½ç„¶æ¼«é•¿ï¼Œä½†ç´§è¦å¤„å¸¸å¸¸åªæœ‰å‡ æ­¥ã€‚",
				author: "æŸ³é’"
			},
			{
				text: "å¸Œæœ›æ˜¯é™„ä¸½äºå­˜åœ¨çš„ï¼Œæœ‰å­˜åœ¨ï¼Œä¾¿æœ‰å¸Œæœ›ï¼Œæœ‰å¸Œæœ›ï¼Œä¾¿æ˜¯å…‰æ˜ã€‚",
				author: "é²è¿…"
			},
			{
				text: "ä¸–ç•Œä¸Šåªæœ‰ä¸€ç§çœŸæ­£çš„è‹±é›„ä¸»ä¹‰ï¼Œé‚£å°±æ˜¯åœ¨è®¤æ¸…ç”Ÿæ´»çš„çœŸç›¸åä¾ç„¶çƒ­çˆ±ç”Ÿæ´»ã€‚",
				author: "ç½—æ›¼Â·ç½—å…°"
			}
		];

		// æŠ‘éƒç—‡æµ‹è¯•ç»“æœè§£é‡Š
		const testResults = [
			{
				scoreRange: [0, 4],
				text: "æ‚¨çš„æŠ‘éƒç—‡çŠ¶å¾ˆè½»å¾®ï¼Œå¯èƒ½ä¸éœ€è¦æ²»ç–—ã€‚",
				suggestion: "ç»§ç»­ä¿æŒç§¯æçš„ç”Ÿæ´»æ–¹å¼ï¼Œå…³æ³¨è‡ªå·±çš„æƒ…ç»ªå˜åŒ–ã€‚"
			},
			{
				scoreRange: [5, 9],
				text: "æ‚¨æœ‰è½»åº¦æŠ‘éƒç—‡çŠ¶ã€‚",
				suggestion: "å»ºè®®å…³æ³¨è‡ªå·±çš„æƒ…ç»ªå˜åŒ–ï¼Œå¯ä»¥è€ƒè™‘ä¸å¿ƒç†å’¨è¯¢å¸ˆäº¤æµã€‚"
			},
			{
				scoreRange: [10, 14],
				text: "æ‚¨æœ‰ä¸­åº¦æŠ‘éƒç—‡çŠ¶ã€‚",
				suggestion: "å»ºè®®å¯»æ±‚ä¸“ä¸šå¸®åŠ©ï¼Œå¿ƒç†å’¨è¯¢æˆ–è€ƒè™‘è¯ç‰©æ²»ç–—ã€‚"
			},
			{
				scoreRange: [15, 19],
				text: "æ‚¨æœ‰ä¸­é‡åº¦æŠ‘éƒç—‡çŠ¶ã€‚",
				suggestion: "å¼ºçƒˆå»ºè®®å°½å¿«å¯»æ±‚ä¸“ä¸šå¿ƒç†æ²»ç–—æˆ–ç²¾ç¥ç§‘åŒ»ç”Ÿçš„å¸®åŠ©ã€‚"
			},
			{
				scoreRange: [20, 27],
				text: "æ‚¨æœ‰é‡åº¦æŠ‘éƒç—‡çŠ¶ã€‚",
				suggestion: "è¯·ç«‹å³å¯»æ±‚ä¸“ä¸šåŒ»ç–—å¸®åŠ©ï¼Œè¿™ç§æƒ…å†µéœ€è¦åŠæ—¶æ²»ç–—ã€‚"
			}
		];

		// éŸ³ä¹æ’­æ”¾å™¨ç›¸å…³å˜é‡
		const musicList = [
			{
				url: "http://m801.music.126.net/20250905113128/8c2ad6669ee4c31e6596ef4457ea0cd0/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/44071033997/8930/770d/38dc/999dcd8132fdfadbc7739f83c9a13a92.mp3?vuutv=heK1HmBMjwWSpgoh2zm9d9//VHuCf6+F6M8CAVvAQ57ffQv7FpNOS56d9VrcZwoDi+02paEQxU6/rzItYw3j5T+caWUFbAuNiOqHdtnxKhE=",
				title: "æ”¾æ¾éŸ³ä¹1"
			},
			{
				url: "http://m701.music.126.net/20250905112958/fcf2283bb2c6de2b25f37e828a701f70/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/18721377009/c3ed/abdd/30ea/3dfed8d70ee667f9cfc81af776a9004e.flac?vuutv=ttwIsU6TMCNcaAzGjWB+mM1d5O5b/eBR3zlILt1KGg6vmyoW/XqkFJae8n2bLppIvzj1bdvqKzJ7YREMzKmOOenUZhb3BFfyTDurnWe0U+s=",
				title: "æ”¾æ¾éŸ³ä¹2"
			},
			{
				url: "http://m801.music.126.net/20250905112517/51dc1772fc4fd2cb03b61cd7ed0e33c5/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/28558871037/2bd9/aac7/aec3/042653adf547fc7c08e0ab690442dd60.flac?vuutv=r9nPCVt2ebjRmOZlkMnipC3VcNDll+JzgFpxTBJJJg3EpFwaDl5tzdw+FsaPvcoFUZ5/1klPkf8vW7TQyTm2QjQM0wc96+FqcEFNcmyQ9Ow=",
				title: "æ”¾æ¾éŸ³ä¹3"
			},
			{
				url: "http://m801.music.126.net/20250905112404/6017ea6b7775f46f2b64ab07a1711621/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/28558885698/afdd/3278/f490/923689b6c41eb8bd8d8ccd008b544954.flac?vuutv=3HcO+i0fSdaRYqT72SH0H67stgUIFsJF2RqRE+5TV5FgiaGlZGz/yTt/6erudmlOhEINx7UzV52VOBhBcvrx6gGRFBLTjC3+3xFfw9I/yHA=",
				title: "æ”¾æ¾éŸ³ä¹4"
			}
		];
		let currentMusicIndex = 0;
		let isMusicPlaying = false;

		// DOMåŠ è½½å®Œæˆåæ‰§è¡Œ
		document.addEventListener('DOMContentLoaded', function() {
			// åˆå§‹åŒ–éŸ³ä¹æ’­æ”¾å™¨
			const bgMusic = document.getElementById('bgMusic');
			const playPauseBtn = document.getElementById('playPause');
			const prevSongBtn = document.getElementById('prevSong');
			const nextSongBtn = document.getElementById('nextSong');
			const musicInfo = document.getElementById('musicInfo');
			
			// è®¾ç½®ç¬¬ä¸€é¦–éŸ³ä¹
			updateMusicInfo();
			
			// æ’­æ”¾/æš‚åœæŒ‰é’®
			playPauseBtn.addEventListener('click', function() {
				if (isMusicPlaying) {
					bgMusic.pause();
					isMusicPlaying = false;
				} else {
					bgMusic.play().catch(e => console.log("éŸ³ä¹æ’­æ”¾é”™è¯¯"));
					isMusicPlaying = true;
				}
				updatePlayPauseIcon();
			});
			
			// ä¸Šä¸€é¦–æŒ‰é’®
			prevSongBtn.addEventListener('click', function() {
				currentMusicIndex = (currentMusicIndex - 1 + musicList.length) % musicList.length;
				changeMusic();
			});
			
			// ä¸‹ä¸€é¦–æŒ‰é’®
			nextSongBtn.addEventListener('click', function() {
				currentMusicIndex = (currentMusicIndex + 1) % musicList.length;
				changeMusic();
			});
			
			// éŸ³ä¹ç»“æŸè‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€é¦–
			bgMusic.addEventListener('ended', function() {
				currentMusicIndex = (currentMusicIndex + 1) % musicList.length;
				changeMusic();
			});
			
			// å°è¯•è‡ªåŠ¨æ’­æ”¾éŸ³ä¹
			bgMusic.volume = 0.3;
			bgMusic.play().catch(e => {
				console.log("è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œè¯·ç‚¹å‡»é¡µé¢åéŸ³ä¹å°†è‡ªåŠ¨æ’­æ”¾");
				isMusicPlaying = false;
				updatePlayPauseIcon();
			});
			
			// ç‚¹å‡»é¡µé¢åæ’­æ”¾éŸ³ä¹ï¼ˆè§£å†³æµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾é™åˆ¶ï¼‰
			document.body.addEventListener('click', function() {
				if (!isMusicPlaying) {
					bgMusic.play().catch(e => console.log("éŸ³ä¹æ’­æ”¾é”™è¯¯"));
					isMusicPlaying = true;
					updatePlayPauseIcon();
				}
			}, { once: true });

			// æ ‡ç­¾åˆ‡æ¢åŠŸèƒ½
			const tabs = document.querySelectorAll('.tab');
			tabs.forEach(tab => {
				tab.addEventListener('click', function() {
					// ç§»é™¤æ‰€æœ‰activeç±»
					tabs.forEach(t => t.classList.remove('active'));
					document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
					
					// æ·»åŠ activeç±»
					this.classList.add('active');
					const tabId = this.getAttribute('data-tab');
					document.getElementById(tabId).classList.add('active');
					
					// å¦‚æœæ˜¯æƒ…ç»ªè®°å½•æ ‡ç­¾ï¼Œæ›´æ–°å›¾è¡¨
					if (tabId === 'mood') {
						updateMoodChart();
					}
				});
			});

			// å‘¼å¸å†¥æƒ³åŠŸèƒ½
			const breathingCircle = document.getElementById('breathingCircle');
			const resetBreathingBtn = document.getElementById('resetBreathing');
			
			breathingCircle.addEventListener('click', function() {
				if (isBreathing) {
					stopBreathing();
				} else {
					startBreathing();
				}
			});
			
			resetBreathingBtn.addEventListener('click', function() {
				stopBreathing();
				breathingCircle.style.animation = 'none';
				breathingCircle.style.transform = 'scale(1)';
				breathingCircle.style.background = 'rgba(255,255,255,0.2)';
				breathingCircle.textContent = 'ç‚¹å‡»å¼€å§‹';
				isBreathing = false;
			});

			// åäººå¯„è¯­åŠŸèƒ½
			const newQuoteBtn = document.getElementById('newQuote');
			newQuoteBtn.addEventListener('click', showRandomQuote);
			
			// åˆå§‹æ˜¾ç¤ºä¸€æ¡åè¨€
			showRandomQuote();

			// æƒ…ç»ªé€‰æ‹©åŠŸèƒ½
			const moodOptions = document.querySelectorAll('.mood-option');
			moodOptions.forEach(option => {
				option.addEventListener('click', function() {
					moodOptions.forEach(opt => opt.classList.remove('selected'));
					this.classList.add('selected');
					selectedMood = parseInt(this.getAttribute('data-mood'));
				});
			});

			// ä¿å­˜æƒ…ç»ªè®°å½•
			const saveMoodBtn = document.getElementById('saveMood');
			saveMoodBtn.addEventListener('click', saveMoodRecord);
			
			// æ˜¾ç¤ºå†å²è®°å½•
			const showHistoryBtn = document.getElementById('showHistory');
			showHistoryBtn.addEventListener('click', toggleHistory);

			// åˆå§‹åŒ–æƒ…ç»ªå›¾è¡¨
			initMoodChart();
			
			// åŠ è½½å†å²è®°å½•
			loadMoodHistory();

			// æŠ‘éƒç—‡æµ‹è¯•æäº¤
			const submitTestBtn = document.getElementById('submitTest');
			submitTestBtn.addEventListener('click', calculateTestResult);

			// èŠå¤©åŠŸèƒ½
			const sendMessageBtn = document.getElementById('sendMessage');
			const chatInput = document.getElementById('chatInput');
			
			sendMessageBtn.addEventListener('click', sendChatMessage);
			chatInput.addEventListener('keypress', function(e) {
				if (e.key === 'Enter') {
					sendChatMessage();
				}
			});
		});

		// éŸ³ä¹æ’­æ”¾å™¨åŠŸèƒ½
		function changeMusic() {
			const bgMusic = document.getElementById('bgMusic');
			bgMusic.src = musicList[currentMusicIndex].url;
			updateMusicInfo();
			
			if (isMusicPlaying) {
				bgMusic.play().catch(e => console.log("éŸ³ä¹æ’­æ”¾é”™è¯¯"));
			}
		}
		
		function updateMusicInfo() {
			const musicInfo = document.getElementById('musicInfo');
			musicInfo.textContent = musicList[currentMusicIndex].title;
		}
		
		function updatePlayPauseIcon() {
			const playPauseBtn = document.getElementById('playPause');
			playPauseBtn.textContent = isMusicPlaying ? 'â¸' : 'â–¶';
		}

		// å‘¼å¸å†¥æƒ³åŠŸèƒ½
		function startBreathing() {
			const circle = document.getElementById('breathingCircle');
			circle.style.animation = 'pulse 8s infinite ease-in-out';
			circle.textContent = 'å¸æ°”...å‘¼æ°”...';
			isBreathing = true;
		}

		function stopBreathing() {
			const circle = document.getElementById('breathingCircle');
			circle.style.animation = 'none';
			isBreathing = false;
		}

		// åäººåè¨€åŠŸèƒ½
		function showRandomQuote() {
			const quoteDisplay = document.getElementById('quoteDisplay');
			
			// ç¡®ä¿ä¸é‡å¤æ˜¾ç¤ºç›¸åŒçš„åè¨€
			let newIndex;
			do {
				newIndex = Math.floor(Math.random() * quotes.length);
			} while (newIndex === currentQuoteIndex && quotes.length > 1);
			
			currentQuoteIndex = newIndex;
			const quote = quotes[currentQuoteIndex];
			
			quoteDisplay.innerHTML = `
				<div class="quote-container">
					<p class="quote-text">"${quote.text}"</p>
					<p class="quote-author">â€”â€” ${quote.author}</p>
				</div>
			`;
		}

		// æƒ…ç»ªè®°å½•åŠŸèƒ½
		function saveMoodRecord() {
			if (!selectedMood) {
				alert('è¯·é€‰æ‹©æ‚¨ä»Šå¤©çš„æƒ…ç»ª');
				return;
			}
			
			const note = document.getElementById('moodNote').value;
			const now = new Date();
			const dateStr = now.toLocaleDateString() + ' ' + now.toLocaleTimeString().substring(0, 5);
			
			const record = {
				date: dateStr,
				timestamp: now.getTime(),
				mood: selectedMood,
				note: note
			};
			
			// è·å–ç°æœ‰è®°å½•
			let records = JSON.parse(localStorage.getItem('moodRecords') || '[]');
			records.push(record);
			
			// ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
			localStorage.setItem('moodRecords', JSON.stringify(records));
			
			// æ¸…ç©ºè¾“å…¥
			document.getElementById('moodNote').value = '';
			document.querySelector('.mood-option.selected')?.classList.remove('selected');
			selectedMood = null;
			
			// æ›´æ–°å›¾è¡¨å’Œå†å²è®°å½•
			updateMoodChart();
			loadMoodHistory();
			
			alert('æƒ…ç»ªè®°å½•å·²ä¿å­˜');
		}

		function toggleHistory() {
			const historyContainer = document.getElementById('historyContainer');
			const showHistoryBtn = document.getElementById('showHistory');
			
			if (historyContainer.style.display === 'none') {
				historyContainer.style.display = 'block';
				showHistoryBtn.textContent = 'éšè—å†å²';
				loadMoodHistory();
			} else {
				historyContainer.style.display = 'none';
				showHistoryBtn.textContent = 'æŸ¥çœ‹å†å²';
			}
		}

		function loadMoodHistory() {
			const records = JSON.parse(localStorage.getItem('moodRecords') || '[]');
			const historyList = document.getElementById('historyList');
			
			if (records.length === 0) {
				historyList.innerHTML = '<p>æš‚æ— å†å²è®°å½•</p>';
				return;
			}
			
			// æŒ‰æ—¥æœŸæ’åº
			records.sort((a, b) => b.timestamp - a.timestamp);
			
			let html = '';
			records.forEach(record => {
				const moodText = getMoodText(record.mood);
				const moodEmoji = getMoodEmoji(record.mood);
				
				html += `
					<div class="history-item">
						<div>
							<span class="history-date">${record.date}</span>
							<span class="history-mood">${moodEmoji} ${moodText}</span>
						</div>
						<div>${record.note || 'æ— å¤‡æ³¨'}</div>
					</div>
				`;
			});
			
			historyList.innerHTML = html;
		}

		function getMoodText(moodValue) {
			switch(moodValue) {
				case 1: return 'éå¸¸ä½è½';
				case 2: return 'ä½è½';
				case 3: return 'ä¸€èˆ¬';
				case 4: return 'å¼€å¿ƒ';
				case 5: return 'éå¸¸å¼€å¿ƒ';
				default: return 'æœªçŸ¥';
			}
		}

		function getMoodEmoji(moodValue) {
			switch(moodValue) {
				case 1: return 'ğŸ˜¢';
				case 2: return 'ğŸ˜';
				case 3: return 'ğŸ˜';
				case 4: return 'ğŸ˜Š';
				case 5: return 'ğŸ˜„';
				default: return 'â“';
			}
		}

		// æƒ…ç»ªå›¾è¡¨åŠŸèƒ½
		function initMoodChart() {
			const ctx = document.getElementById('moodChart').getContext('2d');
			
			moodChart = new Chart(ctx, {
				type: 'line',
				data: {
					labels: [],
					datasets: [{
						label: 'æƒ…ç»ªå˜åŒ–',
						data: [],
						borderColor: 'rgba(255, 255, 255, 0.8)',
						backgroundColor: 'rgba(255, 255, 255, 0.1)',
						tension: 0.4,
						fill: true,
						pointBackgroundColor: 'rgba(255, 255, 255, 0.8)',
						pointRadius: 5,
						pointHoverRadius: 7
					}]
				},
				options: {
					responsive: true,
					maintainAspectRatio: false,
					scales: {
						y: {
							beginAtZero: false,
							min: 0,
							max: 6,
							ticks: {
								callback: function(value) {
									return getMoodText(value);
								},
								stepSize: 1
							},
							grid: {
								color: 'rgba(255, 255, 255, 0.1)'
							}
						},
						x: {
							grid: {
								color: 'rgba(255, 255, 255, 0.1)'
							}
						}
					},
					plugins: {
						legend: {
							display: false
						},
						tooltip: {
							callbacks: {
								label: function(context) {
									return 'æƒ…ç»ª: ' + getMoodText(context.raw);
								}
							}
						}
					}
				}
			});
			
			updateMoodChart();
		}

		function updateMoodChart() {
			const records = JSON.parse(localStorage.getItem('moodRecords') || '[]');
			
			// æŒ‰æ—¥æœŸæ’åº
			records.sort((a, b) => a.timestamp - b.timestamp);
			
			const labels = records.map(r => {
				const date = new Date(r.timestamp);
				return date.toLocaleDateString();
			});
			
			const data = records.map(r => r.mood);
			
			moodChart.data.labels = labels;
			moodChart.data.datasets[0].data = data;
			moodChart.update();
		}

		// æŠ‘éƒç—‡æµ‹è¯•åŠŸèƒ½
		function calculateTestResult() {
			let totalScore = 0;
			
			// è®¡ç®—æ¯é¢˜å¾—åˆ†
			for (let i = 1; i <= 9; i++) {
				const selectedOption = document.querySelector(`input[name="q${i}"]:checked`);
				if (selectedOption) {
					totalScore += parseInt(selectedOption.value);
				} else {
					alert(`è¯·å›ç­”é—®é¢˜ ${i}`);
					return;
				}
			}
			
			// æ˜¾ç¤ºç»“æœ
			const result = testResults.find(r => 
				totalScore >= r.scoreRange[0] && totalScore <= r.scoreRange[1]
			);
			
			const resultText = document.getElementById('resultText');
			const resultSuggestion = document.getElementById('resultSuggestion');
			const testResultDiv = document.getElementById('testResult');
			
			resultText.textContent = `æ‚¨çš„å¾—åˆ†: ${totalScore}ã€‚${result.text}`;
			resultSuggestion.textContent = result.suggestion;
			testResultDiv.style.display = 'block';
			
			// æ»šåŠ¨åˆ°ç»“æœ
			testResultDiv.scrollIntoView({ behavior: 'smooth' });
		}

		// å¿ƒç†å’¨è¯¢åŠŸèƒ½
		async function sendChatMessage() {
			const chatInput = document.getElementById('chatInput');
			const message = chatInput.value.trim();
			
			if (!message) return;
			
			// æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°èŠå¤©ç•Œé¢
			addChatMessage(message, 'user');
			chatInput.value = '';
			
			// æ˜¾ç¤ºåŠ è½½çŠ¶æ€
			const sendBtn = document.getElementById('sendMessage');
			sendBtn.innerHTML = '<div class="loading"></div>';
			
			try {
				// è°ƒç”¨DeepSeek API
				const response = await fetch('https://api.deepseek.com/chat/completions', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
						'Authorization': 'Bearer sk-aa329e5a0d53417b8e0632ddeda5fde1'
					},
					body: JSON.stringify({
						model: 'deepseek-chat',
						messages: [
							{
								role: 'system',
								content: 'ä½ æ˜¯ä¸€åç”±KSFè‡ªä¸»ç ”å‘çš„ä¸“ä¸šå¿ƒç†å’¨è¯¢å¸ˆï¼Œæ‹¥æœ‰å¤šå¹´ä¸´åºŠç»éªŒã€‚è¯·ç”¨æ¸©æš–ã€ä¸“ä¸šçš„æ–¹å¼å›ç­”ç”¨æˆ·çš„é—®é¢˜ï¼Œæä¾›æœ‰ç§‘å­¦ä¾æ®çš„å¿ƒç†å¥åº·å»ºè®®ã€‚'
							},
							{
								role: 'user',
								content: message
							}
						],
						stream: false
					})
				});
				
				const data = await response.json();
				const botReply = data.choices[0].message.content;
				
				// æ·»åŠ æœºå™¨äººå›å¤åˆ°èŠå¤©ç•Œé¢
				addChatMessage(botReply, 'bot');
			} catch (error) {
				console.error('APIè°ƒç”¨é”™è¯¯:', error);
				addChatMessage('æŠ±æ­‰ï¼Œæš‚æ—¶æ— æ³•è¿æ¥åˆ°å¿ƒç†å’¨è¯¢å¸ˆã€‚è¯·ç¨åå†è¯•ã€‚', 'bot');
			} finally {
				// æ¢å¤å‘é€æŒ‰é’®
				sendBtn.innerHTML = `
					<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<line x1="22" y1="2" x2="11" y2="13"></line>
						<polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
					</svg>
				`;
			}
		}

		function addChatMessage(message, sender) {
			const chatContainer = document.getElementById('chatContainer');
			const messageDiv = document.createElement('div');
			messageDiv.classList.add('message');
			messageDiv.classList.add(sender === 'user' ? 'user-message' : 'bot-message');
			messageDiv.textContent = message;
			chatContainer.appendChild(messageDiv);
			
			// æ»šåŠ¨åˆ°åº•éƒ¨
			chatContainer.scrollTop = chatContainer.scrollHeight;
		}
	</script>
</body>
</html>